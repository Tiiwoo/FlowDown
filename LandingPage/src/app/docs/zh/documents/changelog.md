# 变更日志

以下日志记录了浮望的版本更新历史与变更详情。

## 4.1.2

- 推理设置新增 Apple Intelligence 开关与可用性提示，默认对话/辅助模型会随开关调整。
- 云端模型支持选择 OpenAI 请求格式（`/v1/chat/completions` 或 `/v1/responses`），可自动根据端点推断并按所选格式路由。
- 温度预设新增“禁用（-1）”选项，允许将采样温度完全交由服务端控制。
- 云端模型编辑器优化：整合验证/导出/复制操作，并强化端点、Header 与 Body 编辑体验，便于维护模型配置。

## 3.10.11

### 记忆系统

- **智能回忆**：自动调用相关记忆，提供更具个性化的回应。
- **记忆范围设置**：支持设置分享的记忆范围（过去一天/一周/一月，或最近 15/30 条内容）。

### 快捷指令集成

- **快速操作**：支持启动应用、发送消息并获取回应。
- **内容分类**：支持对文本和图片进行分类。
- **智能摘要**：支持为长文本生成段落或要点式摘要。
- **对话工具**：支持搜索聊天、切换模型、创建对话链接。
- **图像分析**：支持图文混合分析（需要 iOS 18+）。

### 界面优化

- **滑动手势**：列表项支持滑动操作，可快速收藏、删除或复制对话。
- **视觉改进**：优化了动画效果与界面视觉层级。

## 3.10.10

- 修复了近期报告的稳定性回退问题，提升内置免费模型池对上游变更的适配能力。
- 调整 CloudKit 同步策略，在多设备快速切换时减少重复拉取。
- 为即将生效的 macOS/iPadOS 公证要求预先优化发布流程。

## 3.10.8

从 3.10 版本开始，我们将次版本号从构建号改为语义化版本以提升辨识度。

- 增强对 Pollinations AI 新端点的自适应解析，新模型无需等待 App 更新。
- 新增自定义请求体编辑器，可在模型档案内为推理请求设置高级参数。
- 上下文菜单改用系统原生实现，在 iOS 与 macOS 上保持一致的交互体验。
- 重构云同步调度，在多设备同时工作时减少潜在冲突。

## 3.8

- **云同步**：全面启用 CloudKit，同步状态在侧边栏实时显示，设置 → 数据控制中可配置同步范围与手动刷新。
- **数据管理**：支持导出/导入签名 `.zip` 备份，并能在不影响本地缓存的情况下清除 iCloud 数据。
- **模型库**：为云端模型设置自定义昵称，便于快速切换。
- **性能与日志**：加快删除流程、优化刷新管线，并新增“支持”日志控制台，方便排查问题。

## 3.6.419

- 发布面向资深用户的 CloudKit 早期构建。升级会将数据库迁移到 V2 架构，无法回退。
- 同步在 GitHub 提供提醒，方便倾向手动安装的用户获取。

## 3.6

- 通过 TestFlight 推出 iCloud 同步测试版，标记为不稳定版本并明确提示潜在数据丢失风险，建议安装前做好备份。
- TestFlight 加入链接：`https://testflight.apple.com/join/StpMeybv`。

## 3.5

- 编辑器栏新增长按工具快捷菜单，可快速启用/停用模型工具。
- 国庆节期间限免活动已于 2025-10-06 结束，老用户可按公告指引申请其他应用兑换码。

## 3.4

- 推出沉浸式对话界面。
- 强化 Apple Foundation 模型支持，尤其在配合 Apple Intelligence 时的体验。
- 由于第三方库编译问题，macOS 桌面版稍晚释出，修复随后发布。

## 3.2

- 新增模型级温度控制，可精细平衡创意与准确性。
- 初步支持 Apple Foundation 模型，并升级 MLX 依赖提升性能。

## 历史版本（1.x–2.x）

<details>
<summary>展开存档历史</summary>

## iOS 2.9 / macOS 2.9.1 (370)

### 修复与改进

- **编辑器与渲染**

  - 修复了多行方程式渲染的问题。
  - 解决了 iPad 上指针设备文本选择的问题。
  - 修复了当服务器返回错误时，流式任务无法被正确取消的错误。

- **MCP 服务器**

  - 修复了编辑时阻止 MCP 服务器连接的严重错误。
  - 修复了 MCP 服务中连接时必需字段丢失的错误。

- **常规界面**
  - 纠正了 iPad 上侧边栏行为异常的问题。
  - 修复了在模型管理页面上菜单位置显示不正确的问题。

## 2.6 (357)

### 修复与改进

- **MCP 服务器连接**

  - 修复了一个在编辑 MCP 服务器时可能导致无法连接的严重错误。
  - 改进了 MCP 的连接管理机制。

- **任务管理与稳定性**

  - 修复了当服务器返回错误时，流式响应无法被正确取消的问题。
  - 解决了若干线程问题，提升了应用的稳定性。

- **用户界面 (UI)**
  - 纠正了在模型管理页面上，菜单位置显示不正确的问题。
  - 修复了在 iPad 设备上，侧边栏行为异常的问题。

## 2.2 (330)

### 主要特性

- **新增 MCP 服务器支持**

  - 支持添加、管理和编辑 MCP 服务器。
  - 新增 `.fdmcp` 文件，支持拖拽和选择器操作。

- **编辑器与 UI 优化**

  - 新建会话后自动聚焦编辑器。
  - MarkdownView 支持框选时滚动。
  - ToolHintView 布局与响应速度优化。

- **其他**
  - 支持自定义品牌名称。

### 修复改进

- **Bug 修复**
  - 修复 Mac Catalyst 下编辑器焦点行为。

## 2.0 (324)

### 新功能

- **全局搜索**：现在可以在所有会话中搜索关键词。

### 改进

- **重写的 Markdown 文本引擎**：我们从零重构了核心文本引擎，带来：
  - **显著的性能提升**
  - **更好的数学公式渲染兼容性**
  - **代码高亮增强**，不再出现闪烁现象

### 问题修复

- 解决了内容流式传输时文本高亮和表格视图会闪烁的问题。
- 修复了响应流式传输时无法复制文本的问题。

## 1.26 (262)

本次更新带来了多项新功能，并修复了关键问题以提升您的使用体验。

### 新功能

- **AI 驱动的模板重写**：现在可以使用 AI 结合额外指令重写聊天模板。
- **模板管理**：
  - 支持通过拖放轻松调整聊天模板顺序。
  - 新增导出和打开聊天模板文件的功能。
- **收藏会话**：可将任意会话标记为收藏，便于快速访问。
- **拖放导出**：现在可通过拖放方式导出 `fdmodel` 文件。

### 改进

- **侧边栏增强**：
  - 侧边栏现可在 macOS 上折叠。
  - 侧边栏宽度现可在 iPad 和 macOS 上调整。
  - 在 iPad 上可设置侧边栏始终显示，提升导航体验。

### 问题修复

- **界面**：修复了聊天视图阴影未正确渲染的问题。

## 1.25 (250)

- 支持流式传输并防止 FoundationModels 拒绝请求（@at-wr）
- 改善了在配备 Magic Keyboard 的 iPad 上的应用体验（@at-wr）
- 新建会话时如未指定模型标识符则自动设置默认值（@at-wr）
- CloudModel 支持自定义解码以处理可选属性（@at-wr）

## 1.24 (242)

- 在 FoundationModels 的数据结构中加入 `@generable`（@at-wr）
- 修复了从压缩器新建聊天时的多处崩溃问题（@at-wr）

## 1.24 (241)

- 新增压缩为新聊天功能
- 新增重写操作
- 针对 #16 新增重做功能
- 改进了提示词中的多行 LaTeX 支持

## 1.23 (231)

- 云模型支持自定义请求头
- 修复了 ESC 键无响应的问题
- 修复了不必要的抖动行为
- 修复了错误合并导致 HTTP-Referer 头丢失的问题
- 更新了键盘逻辑

## 1.22 (223)

- 小幅修复与改进

## 1.22 (222)

- 小幅修复与改进

## 1.21 (210)

- PDF 导入增强：智能 PDF 处理，支持文本提取或图片转换双模式
- 改进了大文件的错误处理
- 聊天快速切换的键盘导航快捷键
- 菜单栏模板集成：可直接从菜单栏访问模板
- 菜单栏新增模板菜单（@at-wr）
- 新增会话间切换快捷键（@at-wr）

## 1.20 (200/201/202)

### 聊天模板系统

- 全新可复用模板功能和模板编辑器
- 基于历史对话自动生成任务模板
- 新增从模板创建会话的入口

### 核心优化

- 修复 iOS/iPadOS 权限校验缺失问题
- 重新启用端侧视觉语言模型(VLM)支持
- 新增 Google Gemma3 模型接入
- 代码预览器现支持 HTML 渲染
- 优化多处交互逻辑

## 1.19 (190)

- 添加了新的菜单项
- 添加了首次打开的欢迎日志
- 改善了 OpenRouter 的集成
- 修复了在 Mac 上新建聊天时输入框无法自动聚焦的问题
- 改善了应用的后台处理能力
- 修复了一些情况下推理内容没有更新的问题
- 修复了模型工具相关的逻辑错误

感谢以下贡献者的参与：

- @at-wr
- @Zach677

## 1.13 (130)

- 修复了在代码视图中使用键盘快捷键复制文本无效的问题
- 修复了选择文本时光标显示不正确的问题
- 修复了在文本首行和末行拖拽手势无响应的问题
- 修复了代码语法高亮未应用的问题
- 修复了推理请求被添加到辅助任务中的问题
- 添加了需要时使用开发者角色的选项
- 应用现在可以通过 flowdown:// 协议打开
- 应用现在可以就地打开模型文件

## 1.11

- 修复了复制模型时新模型标识符不正确的问题
- 修复了数学内容无法正确渲染的问题
- 修复了右键点击对话列表时菜单消失的问题
- 修复了网页搜索后文档未被索引的问题

## 1.10 (101/102)

- 改进了视觉任务调度器，为视觉原生模型新增跳过辅助任务的选项
- 修复了编辑器在处理大型图片时卡顿的问题
- 修复了编辑器无法恢复可编辑内容的问题
- 改进了辅助任务结构并提升了执行速度
- 改进了启用工具调用时网页搜索的数据流
- 修复了图像识别任务中推理内容缺失的问题
- 添加了对 OpenRouter 模型推理令牌的支持

## 1.9 (90)

- 添加了对数学内容的初步支持
- 支持 LaTeX 格式的数学公式显示

## 1.7 (70)

- 修复了 Qwen3 本地模型支持问题
- 更新了 MLX 模型清单结构以修复兼容性问题
- 本地视觉功能暂时不可用，等待上游修复
- 浮望现已完全开源，用户可自行验证隐私保护承诺

## 1.6 (60)

- 改进了本地模型支持
- 修复了多个已知问题

## 1.5 (50)

- 修复了粘贴内容时的异常行为
- 修复了网页搜索阶段指示器的异常行为
- 修复了输入框上的返回键标题错误
- 修复了同时接收多个工具调用时的错误
- 添加了通过 OLLAMA 和 LM Studio 连接到本地托管 LLM 的支持

## 1.4 (49)

- 修复了位置工具在位置服务未启用时的崩溃问题

## 1.4 (47/48)

- 修复了表格边框颜色没有正确更新的问题
- 修复了删除消息时连续快速操作可能导致的崩溃
- 当附件存在时允许发送空消息
- 添加了直接选择文本的能力

## 1.3 (44)

- 修复了部分推理模型的崩溃问题
- 修复了列表意外显示为正在推理的问题
- 修复了聊天列表元素位置计算错误的问题
- 修复了部分模型推理端点不支持用量统计导致的无法使用
- 修复了崩溃导致推理内容没有保存的问题
- 修复了抱抱脸模型下载页面代码块无法打开详情的问题
- 修复了代码块和表格在特殊情况下无法使用正确信息的问题
- 修复了中断推理可能出现的逻辑错误
- 修复了重试过程中删除错误消息的问题
- 针对不支持 MLX 的设备禁用本地模型功能
- 调整了几处菜单的顺序和逻辑
- 调整了删除对话内容的逻辑
- 调整了编辑对话内容的逻辑
- 添加了 Command + Enter 来发送的选项
- 添加了长按来换行的选项
- 添加了保存回复内容为图片的选项
- 删除了临时聊天的选项

## 1.2 (36/37/42)

- 新增对话内容导出为图片的功能
- 新增随时终止进行中对话的能力
- 改进网页搜索，为搜索结果添加去重算法
- 修复补充视图中文本大小渲染不一致的问题
- 重构代码并解决了多个已知问题

## 1.1 (35)

- 修复了提取的图像信息可能未正确存储的错误
- 修复了系统提示词未正确更新的错误
- 修复了工具调用可能导致服务器错误的问题

## 1.0 (32/33)

首次发布到 App Store。

- 更换软件图标
- 修复 DeepSeek 模型不支持乱序系统提示词的问题
- 修复重试没有使用正确的模型
- 修复工具调用失败的问题，删除了部分模型不支持的参数 `minLength`
- 修复模型不使用最新时间的问题
- 调整工具所使用的提示词
- 添加 64k 上下文长度的选项

## 1.0 (28)

- 受支持的云端模型现可使用工具
- 新增模型选择器右键/长按快捷菜单
- 改善了工具调用的状态显示，部分工具支持查看调用详情
- 添加 64K 上下文的选项
- 解决撤销操作导致应用闪退问题
- 优化模型不可用时的异常处理
- 修复权限相关问题和改进错误提示
- 优化数据导出逻辑和日志系统
- 改进对话前检查机制，提升稳定性

## 1.0 (20)

- 修复菜单事件响应问题
- 修复代码视图高度不匹配问题
- 修复模型名称没有按照预期更新的问题
- 优化对话列表长按交互体验
- 优化推理引擎效率
- 改进 URL 打开机制并添加安全警告提示
- 大幅降低网络爬虫资源消耗
- 替换小组件图标

</details>
